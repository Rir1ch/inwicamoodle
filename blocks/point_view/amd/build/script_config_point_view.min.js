define(["jquery","core/ajax","core/notification"],function(e,t,i){function c(e,c,n,a,o){e.click(function(e){M.util.show_confirm_dialog(e,{message:M.util.get_string(c,"block_point_view"),callback:function(){t.call([{methodname:"block_point_view_"+n,args:a,done:o,fail:i.exception}])}})})}return{init:function(t,n){var a,o,l,s;a=e("#id_config_enable_point_views"),o=e("#id_config_enable_difficultytracks"),(l=function(){var t=a.val()>0,i=o.val()>0;e("#id_activities_header").toggle(t||i),e(".reactions, #id_images_header").toggle(t),e(".difficultytracks").toggle(i)})(),a.change(l),o.change(l),s=function(t){var i=e(".cb"+t+":checkbox"),c=i.filter(":checked").length;e("#enableall"+t).toggleClass("active",c===i.length),e("#disableall"+t).toggleClass("active",0===c)},e(".enablemodulereactions").change(function(){s(e(this).data("type")),s(e(this).data("section"))}),e(".enable-disable button").each(function(){var t=e(this).data("type")||e(this).data("section");s(t),e(this).click(function(){e(".cb"+t+":checkbox").prop("checked",e(this).data("enable")).change()})}),e(".moduletrackselect select").change(function(){e("#track_"+e(this).data("id")).css({"background-color":n[e(this).val()]})}).change(),c(e("#delete_custom_pix"),"deleteemojiconfirmation","delete_custom_pix",{contextid:t.contextid,courseid:t.courseid,draftitemid:e('input[name="config_point_views_pix"]').val()},function(){e('.pix-preview[data-source="custom"], #delete_custom_pix').remove(),document.querySelector("#fitem_id_config_point_views_pix .fp-path-folder-name").click()}),e("[name=config_pixselect]").change(function(){var t=e(this).val();e("img.currentpix").each(function(){var i=e('img[data-source="'+t+'"][data-reaction="'+e(this).data("reaction")+'"]');1==i.length&&i.attr("src")>""&&e(this).attr("src",i.attr("src"))})}),c(e("#reset_reactions"),"resetreactionsconfirmation","update_db",{func:"reset",courseid:t.courseid},function(){i.alert(M.util.get_string("info","moodle"),M.util.get_string("reactionsresetsuccessfully","block_point_view"),M.util.get_string("ok","moodle"))})}}});